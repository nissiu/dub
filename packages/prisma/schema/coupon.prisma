enum CouponStructure {
  percentage
  flat
}

model Coupon {
  id          String          @id @default(cuid())
  programId   String
  couponId    String
  name        String
  amount      Int
  type        CouponStructure
  maxDuration Int? // in months (0 -> one-time, null -> forever)
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt

  couponCodes CouponCode[]
  program     Program      @relation(fields: [programId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@index(programId)
}

model CouponCode {
  id String @id @default(cuid())

  // programId    String
  // partnerId String
  couponId  String
  code      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  links  Link[]
  coupon Coupon @relation(fields: [couponId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@index(couponId)
}
